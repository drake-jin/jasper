---
layout: post
cover: 'assets/images/post/tags/docker.png'
title: (스터디) 도커.araboza - Intro
date: 2017-04-02 00:00:00
tags: docker
subclass: 'post tag-docker'
categories: 'drakejin'
navigation: True
---
[데이터 공작소] 데이터 공작소는 도커는 어떻게 공부할것인가! 처음 시작하는 도커에 대해 공부를 시작합니다. 


## 도커에 대해 공부해보자.

![docker logo](/assets/images/post/2017-04-02/docker.png)

 - 도커는 2013년 docker.inc에서 출시한 *오픈소스 컨테이너* 프로젝트  
 - AWS, Google Cloud Platform, Azure 에서 공식 지원중
  
 
## 도커 장점

 - 복잡한 리눅스 어플리케이션을 컨테이너로 묶어서 실행할 수 있음
 - 개발, 테스트, 서비스 환경을 통일하여 효율적으로 관리할 수 있음
 - *컨테이너(이미지)*를 전세계 사람들과 공유할 수 있음


## 컨테이너란?

 - 가상화보다 훨씬 가벼운 가상화 기술
 - 리눅스 안에 있는 컨테이너 기술을 이용하여 가상공간을 만든다.
 - 하지만 그 만들어진 공간안에 실행파일은 호스트에서 직접 실행한다.
 - 이 컨테이너 기술은 리눅스의 cgroups 와 namespaces가 제공하는 기술
 - 어찌 보면 컨테이너는 가상화가 아닌 격리의 개념과도 같다.
 - 컨테이너에 대한 내용은 아래 링크를 반드시 참조한다. 
 - [도커 가상화의 원리와 장단점](http://opennaru.tistory.com/105)

## 가상화란?

 - 우리가 이용하는 VPS호스팅 임대 서비스들은 가상화를 이용한 클라우드 서비스  
 - 컴퓨터 안에서 컴퓨터를 만들어내기 위한 시도 
 - 1960년대에 가상화라는 개념이 처음 등장
 - 컴퓨터 성능이 좋아지면서 PC에서도 사용함.
 - 맥에서 윈도우를 설치하여 뱅킹을 하는것 처럼...
 - 개인 컴퓨터의 성능이 좋아짐과 동시에 서버 컴퓨터의 성능 또한 더불어 좋아짐.
 - 서버에서 서비스를 운영하면 운영되고 있는 어플리케이션이 소모하는 자원말고 아무것도 사용하고 있지 않음.
 - 그렇다고 Scale out과 활용 사이에 갈등.
 - 그렇다면 서버에 가상머신을 띄워서 놀고 있는 자원을 효율적으로 사용해보자! 
 - 환경에 의존하여 인스톨하지 않고, 이미지를 인스톨하면 즉시 이용 가능할 수 있는 장점이 있음.
 - 하지만 가상화에는 단점들이 존재함, OS를 아예 만들어내기 때문에 자원낭비를 불러옴.
 - 심지어 AMD나 Intel CPU에 가상화 기능을 넣었는대도 자원낭비가 생기고 느리기 까지 함 
 - 그래서 호스트와 커널을 공유하는 반 가상화 기술이 등장했다.
 - 이러나 저러나 가상머신은 느리다. 
 - 가상머신은 항상 완전한 컴퓨터를 설치해야한다. 그렇기 때문에 항상 guest OS를 설치해야만 한다.
 - 이미지 안에 OS가 포함되기 때문에 이미지 용량이 커진다. 
 - 네트워크로 가상화 이미지를 주고 받는건 부담스러움
 - 오픈소스 가상화 소프트웨어는 OS가상화에만 주력(배포와 관리 기능이 부족)
 - 이런 단점으로 인하여 컨테이너 기술이 나옴. (리눅스 컨테이너)
 

### 컨테이너(이미지) 공유 서비스
    - *컨테이너* 기술은 리눅스 커널에서 제공해줌
    - Github과  비슷한 방식의 docker hub란게 존재하여 공유함

### 컨테이너와 이미지의 차이점

    - 이미지 
        1. 서비스 운영에 필요한 서버 프로그램, 소스코드, 컴파일된 실행파일을 묶은 형태 
        2. 저장소에 올리고 받는것은 이미지 : push and pull
    
    - 컨테이너
        1. 컨테이너는 이미지를 이미 실행한 형태
        2. 이미지로 여러개의 컨테이너를 만들 수 있다.
    
    - 즉, 운영체제 측면으로 본다면 이미지는 실행파일, 컨테이너는 프로세스 


## 도커의 특징

 - 도커는 게스트 OS를 설치하지 않는다.
 - 이미지에 서버 운영을 위한 프로그램과 라이브러리만 격리해서 설치
 - 이미지 용량이 크게 줄어든다. 
 - 호스트와 OS자원을 공유(시스템 콜들..)
 - *도커는 하드웨어 가상화 계층이 존재하지 않음*(메모리접근, 파일접근 등등 관련한 기능에서 가상화보다 빠른 성능을 보여줌)
 - 이미지 생성과 배포에 특화됨
 - 이미지 버전관리 제공한다. 중앙저장소에 이미지를 올리고 받을 수 있다 (push/ pull)과정 
 - Github과 비슷한 형태의 서비스인 docker hub가 존재한다. 
 - 다양한 API를 사용하여 원하는 만큼 자동화가 가능함, 개발과 서버운용에 매우 유용함.


### 도커의 버전관리(이미지 처리 방식) 

 - 유니온 파일 시스템 형식 (aufs, btrfs, devicemapper)
 - 도커 베이스 이미지에서 바뀐부분만 이미지로 생성
 - 컨테이너로 실행할 때는 베이스 이미지와 바뀐부분을 합쳐서 실행
 - 즉, Docker Hub 및 개인 저장소에서 이미지를 공유할 때, 바뀐부분만 주고 받음
 - 각 이미지는 매 버전마다 의존관계를 가지게(형성하게) 됨

### 서비스 운영환경에서 도커를 적용하기 이전의 상황 

 - 지금까지는 물리적인 서버를 직접 운영하는 방식이었음.
 - 호스팅 또는 IDC코로케이션 서비스 이용
 - 이전까지는 서버 구입과 운영까지 많은 비용이 소모되고 시간이 오래걸렸다. 
 - 가상화가 발전하면서 클라우드 환경으로 변화
 - 가상 서버를 임대하여 이용한 만큼 돈을 지불하는 방식이었음
 - 단순한 클릭 몇번으로 서버가 생성되었다. 
 - 이제는 자동으로 서버를 생성하고 삭제까지도 할 수 있게 되었다.
 - 현재는 서버 대수가 많아지게되면서 관리하기가 힘들어지게 됨
 - 그렇다면 많아진 서버 대수를 어떻게 셋팅하고 배포를 하게 될 것인가?
 - 이 많아진 서버 대수를 관리하기위한 서버관리 측면의 패러다임이 나오게 됨.
 - Immutable Infrastructure 라는 패러다임이 나옴

### Immutable Infrastructure
 - 호스트 OS와 서비스 운영 환경(서버 프로그램, 소스코드, 컴파일된 바이너리)들을 분리하여 
 - 한번 설정한 서버환경은 변경하지 않는다.(Immutable) 개념
 - 서비스 운영환경을 이미지로 생성한 뒤 서버에 배포하여 실행
 - 서비스가 업데이트 되면 운영환경 자체를 변경하지 않고, 이미지를 새로 생성하여 배포함.
 - 클라우드 플랫폼에서 서버를 쓰고 버리는것과 같이 Immutable Infrastructure도 서비스 운영환경 이미지를 한번 쓰고 버림
    
### Immutable Infrastructure의 장점

 - 편리한 관리
   - 서비스 환경 이미지만 관리하면 된다.
   - 중앙관리를 통한 배포와 관리
   - 이미지 생성에 버전관리 시스템 활용 

 - 확상정
   - 이미지 하나로 서버를 계속해서 찍어낼 수 있음
   - 클라우트 플랫폼의 자동확장(Auto Scaling)기능와 연동하여 손쉽게 서비스를 확장할 수 있다.

 - 테스트
   - 개발자 PC또는 테스트 서버에서 이미지를 실행하면 서비스 운영환경과 동일한 환경이 구축됨
   - 테스트가 간편해진다.

 - 가벼움
   - 운영체제와 서비스환경을 분리하여 가볍고 어디서나 실행가능한 환경을 제공할 수 있다. 

### 즉, 도커는 Immutable Infrastructure를 구현한 프로젝트 이다.


### 도커의 로고
 - 고래
 - 컨테이너를 싣고 다니는 고래  
 - 고래는 서버에서 여러 개의 컨테이너(이미지)를 실행하고 이미지 저장과 배포(운반)을 의미
 - Docker는 부두 노동자를 의미함, 컨테이너를 다루는 도커의 기능과 비슷함. 
 - Build, Ship, Run 도커는 서비스 운영환경을 묶어서 손 쉽게 배포하고 실행하는 경량컨테이너 기술

## 설치

``` bash

$ sudo apt-get install update
$ sudo apt-get install docker.io -y
# 최신 바이너리를 설치하고 싶다면
# 참고링크 1번 프레젠테이션의 91페이지를 참고하세요.
```

 
## 참고 링크
 - ![유명한 도커 입문 슬라이드](https://www.slideshare.net/pyrasis/docker-fordummies-44424016)
 - ![boot2docker](https://docs.docker.com/machine/install-machine/#installing-machine-directly) 마지막부분 내용 좋음



